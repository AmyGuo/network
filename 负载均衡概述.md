#### Server Load Balancer

##### 一、负载均衡常见技术方案：
- 基于DNS负载均衡：在地域上的流量均衡
- 基于硬件负载均衡：主要用于大型服务器集群中的负载需求
- 基于软件负载均衡：基于机器层面的流量均衡

1. DNS负载均衡
- 优点：配置简单，实现成本非常底，无需额外的开发和维护工作
- 缺点：1. 变更生效时间长，当配置修改后，由于dns一般会有多级缓存，会导致ip变更不及时从而影响负载均衡的效果。2. 负载分配不均匀，dns服务器将请求平局分配到后台服务器上，而不考虑每个服务器当前的负载情况，如果服务器的配置和处理能力不同，最慢的服务器将成为系统的瓶颈，处理能力强的服务器不能充分发挥作用。3. 可靠性低，如果后台的服务器出现故障，dns服务器仍然会把请求分配到这台故障服务器上。


2. 硬件负载均衡
- 例子：F5 （是一个网络设备，可以理解为类似网络交换机的东西，每秒处理请求数达百万级，一般是用在大型互联网公司的流量入口最前端，以及政府、国企不缺钱的企业也会用）
- 优点：性能强大，灵活策略，有防火墙功能
- 缺点： 贵

3. 软件负载均衡
- 软件负载均衡是指使用软件的方式来分发和均衡流量。软件负载均衡，分为7层协议和4层协议。
- 例子：LVS(基于网络协议的第四层传输层来做流量分发)，Nginx(基于应用层)
- 传输层和应用层区别：传输层可达几十万每秒，应用层一般是几万每秒
- 优点：在正常服务器上部署即可，无需额外采购，投入一点技术优化即可
- 缺点：网络协议有限，nginx和apache支持http负载

##### 二、常见负载均衡算法/策略：
> 轮询策略
负载度策略
响应策略
哈希策略


1. Random 随机
这是最简单的一种，使用随机数来决定转发到哪台机器上。
优点：简单使用，不需要额外的配置和算法。
缺点：随机数的特点是在数据量大到一定量时才能保证均衡，所以如果请求量有限的话，可能会达不到均衡负载的要求。

2. Round Robin 轮询
这个也很简单，请求到达后，依次转发，不偏不向。每个服务器的请求数量很平均。
缺点：当集群中服务器硬件配置不同、性能差别大时，无法区别对待。引出下面的算法。

3. Weighted Round Robin 加权轮询
这种算法的出现就是为了解决简单轮询策略中的不足。在实际项目中，经常会遇到这样的情况。
比如有5台机器，两台新买入的性能等各方面都特别好，剩下三台老古董。这时候我们设置一个权重，让新机器接收更多的请求。物尽其用、能者多劳嘛！
这种情况下，“均衡“就比较相对了，也没必要做到百分百的平均。

4. Least Connections 最少连接
这是最符合负载均衡算法的一个。需要记录每个应用服务器正在处理的连接数，然后将新来的请求转发到最少的那台上。

5. Source Hashing 源地址散列
根据请求的来源ip进行hash计算，然后对应到一个服务器上。之后所有来自这个ip的请求都由同一台服务器处理。


##### tips
正向代理：代理的是客户端，如VPN
反向代理：代理的是服务端，如Nginx
